{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="content-header">
    <h1>{{ title }}</h1>
    <a href="{{ url_for('admin.add_subject_class') }}" class="btn btn-primary">Add New Class</a>
    <a href="{{ url_for('admin.import_classes_csv') }}" class="btn btn-success">Import Classes from CSV</a>
</div>

{% if classes %}
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Class Name</th>
            <th>Subject</th>
            <th>Teacher</th>
            <th>Schedule</th>
            <th>Academic Year</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for class_item in classes %}
        <tr>
            <td>{{ class_item.id }}</td>
            <td>{{ class_item.name }}</td>
            <td>{{ class_item.subject_taught.name if class_item.subject_taught else 'N/A' }}</td>
            <td>
                {% if class_item.teacher_user %}
                    {{ class_item.teacher_user.first_name }} {{ class_item.teacher_user.last_name }}
                {% else %}
                    <span class="text-muted">Not Assigned</span>
                {% endif %}
            </td>
            <td>{{ class_item.schedule_details if class_item.schedule_details else 'N/A' }}</td>
            <td>{{ class_item.academic_year if class_item.academic_year else 'N/A' }}</td>
            <td>{{ class_item.start_date.strftime('%Y-%m-%d') if class_item.start_date else 'N/A' }}</td>
            <td>{{ class_item.end_date.strftime('%Y-%m-%d') if class_item.end_date else 'N/A' }}</td>
            <td class="actions-column"> {# Added a class for potentially wider actions column #}
                <a href="{{ url_for('admin.edit_subject_class', class_id=class_item.id) }}" class="btn btn-sm btn-outline-primary mb-1">Edit</a>
                <a href="{{ url_for('admin.manage_enrollments', class_id=class_item.id) }}" class="btn btn-sm btn-outline-info mb-1">Enrollments</a> {# ADDED THIS LINE #}
                <form action="{{ url_for('admin.delete_subject_class', class_id=class_item.id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this class? This action cannot be undone and might affect enrollments and attendance records.');">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-sm btn-outline-danger mb-1">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-info" role="alert">
    No subject classes found. <a href="{{ url_for('admin.add_subject_class') }}">Add the first one!</a>
</div>
{% endif %}

<style>
    .content-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    .btn {
        padding: 0.375rem 0.75rem;
        border-radius: 0.25rem;
        text-decoration: none;
        cursor: pointer;
        font-size: 0.9rem;
        line-height: 1.5;
        text-align: center;
        vertical-align: middle;
        user-select: none;
        border: 1px solid transparent;
        margin-right: 5px; /* Add some space between buttons */
    }
    .btn.mb-1 { /* Margin bottom for stacked buttons on small screens if they wrap */
        margin-bottom: 0.25rem !important;
    }
    .btn-primary { color: #fff; background-color: #007bff; border-color: #007bff; }
    .btn-primary:hover { background-color: #0056b3; border-color: #0056b3; }
    .btn-outline-primary { color: #007bff; border-color: #007bff; background-color: transparent; }
    .btn-outline-primary:hover { color: #fff; background-color: #007bff; }
    .btn-outline-danger { color: #dc3545; border-color: #dc3545; background-color: transparent; }
    .btn-outline-danger:hover { color: #fff; background-color: #dc3545; }
    .btn-outline-info { color: #17a2b8; border-color: #17a2b8; background-color: transparent; }
    .btn-outline-info:hover { color: #fff; background-color: #17a2b8; }
    .btn-sm { padding: 0.25rem 0.5rem; font-size: 0.8rem; }
    .btn-success { color: #fff; background-color: #007bff; border-color: #007bff; }
    
    .table { width: 100%; margin-bottom: 1rem; color: #212529; border-collapse: collapse; }
    .table th, .table td { padding: 0.75rem; vertical-align: top; border-top: 1px solid #dee2e6; }
    .table thead th { vertical-align: bottom; border-bottom: 2px solid #dee2e6; text-align: left;}
    .table-striped tbody tr:nth-of-type(odd) { background-color: rgba(0,0,0,.05); }
    .table-hover tbody tr:hover { color: #212529; background-color: rgba(0,0,0,.075); }
    
    .alert { padding: .75rem 1.25rem; margin-bottom: 1rem; border: 1px solid transparent; border-radius: .25rem; }
    .alert-info { color: #0c5460; background-color: #d1ecf1; border-color: #bee5eb; }
    .text-muted { color: #6c757d !important; }

    .actions-column .btn, .actions-column form { /* Ensure buttons/forms in actions column can stack nicely if needed */
        display: block; /* Make them block to stack */
        margin-bottom: 5px; /* Add space between stacked buttons */
    }
    .actions-column form {
        display: inline-block; /* Revert form to inline-block if preferred next to other buttons */
    }
     @media (min-width: 768px) { /* For medium screens and up, make them inline again */
        .actions-column .btn, .actions-column form {
            display: inline-block;
            margin-bottom: 0;
        }
    }

</style>
{% endblock %}
```

**Key Change:**
* Inside the `<tbody>` of the table, within the `<td>` for actions, I've added:
  ```html
  <a href="{{ url_for('admin.manage_enrollments', class_id=class_item.id) }}" class="btn btn-sm btn-outline-info mb-1">Enrollments</a>
  ```
* I also added some minor styling adjustments to the `actions-column` and buttons to help them stack better on very small screens if needed, and then revert to inline for larger screens.

Please replace the content of your `app/templates/admin/subject_classes.html` with this updated version. After restarting your Flask application, you should now see the "Enrollments" button for each class in the list, which will take you to the enrollment management page for that cla
