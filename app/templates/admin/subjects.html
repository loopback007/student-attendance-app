{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="content-header">
    <h1>{{ title }}</h1>
    <a href="{{ url_for('admin.add_subject') }}" class="btn btn-primary">Add New Subject</a>
</div>

{% if subjects %}
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
            <th>Date Created</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for subject in subjects %}
        <tr>
            <td>{{ subject.id }}</td>
            <td>{{ subject.name }}</td>
            <td>{{ subject.description[:100] if subject.description else 'N/A' }}{% if subject.description and subject.description|length > 100 %}...{% endif %}</td>
            <td>{{ subject.date_created.strftime('%Y-%m-%d %H:%M') if subject.date_created else 'N/A' }}</td>
            <td>
                <a href="{{ url_for('admin.edit_subject', subject_id=subject.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>
                <form action="{{ url_for('admin.delete_subject', subject_id=subject.id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this subject? This action cannot be undone.');">
                    {# This input relies on the global csrf_token() function #}
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"> 
                    <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-info" role="alert">
    No subjects found. <a href="{{ url_for('admin.add_subject') }}">Add the first one!</a>
</div>
{% endif %}

<style>
    .content-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .btn { padding: 0.375rem 0.75rem; border-radius: 0.25rem; text-decoration: none; cursor: pointer; font-size: 0.9rem; line-height: 1.5; text-align: center; vertical-align: middle; user-select: none; border: 1px solid transparent; }
    .btn-primary { color: #fff; background-color: #007bff; border-color: #007bff; }
    .btn-primary:hover { background-color: #0056b3; border-color: #0056b3; }
    .btn-outline-primary { color: #007bff; border-color: #007bff; background-color: transparent; }
    .btn-outline-primary:hover { color: #fff; background-color: #007bff; }
    .btn-outline-danger { color: #dc3545; border-color: #dc3545; background-color: transparent; }
    .btn-outline-danger:hover { color: #fff; background-color: #dc3545; }
    .btn-sm { padding: 0.25rem 0.5rem; font-size: 0.8rem; }
    .table { width: 100%; margin-bottom: 1rem; color: #212529; border-collapse: collapse; }
    .table th, .table td { padding: 0.75rem; vertical-align: top; border-top: 1px solid #dee2e6; }
    .table thead th { vertical-align: bottom; border-bottom: 2px solid #dee2e6; }
    .table-striped tbody tr:nth-of-type(odd) { background-color: rgba(0,0,0,.05); }
    .table-hover tbody tr:hover { color: #212529; background-color: rgba(0,0,0,.075); }
    .alert { padding: .75rem 1.25rem; margin-bottom: 1rem; border: 1px solid transparent; border-radius: .25rem; }
    .alert-info { color: #0c5460; background-color: #d1ecf1; border-color: #bee5eb; }
</style>
{% endblock %}
```

After updating `app/__init__.py` to include `csrf.init_app(app)`, restart your Flask application. The `csrf_token()` function should now be available globally in your Jinja templates, and the error should be resolved when you are on the page listing subjects (which is where the delete button with the explicit `csrf_token()` call is locate
